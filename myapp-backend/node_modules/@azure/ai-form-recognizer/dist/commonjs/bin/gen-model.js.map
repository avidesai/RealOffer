{"version":3,"file":"gen-model.js","sourceRoot":"","sources":["../../../src/bin/gen-model.ts"],"names":[],"mappings":";;AAEA,uCAAuC;AACvC,kCAAkC;;AAElC,mHAAmH;AAEnH,8CAAyD;AACzD,+CAA6C;AAC7C,kGAA4F;AAC5F,2DAAqD;AACrD,uCAAkC;AAElC;;;GAGG;AACH,SAAS,SAAS;IAChB,OAAO,CAAC,KAAK,CAAC;;;;;;;;;;;;;;;;;;;;;;CAsBf,CAAC,CAAC;AACH,CAAC;AAED;;;GAGG;AACH,KAAK,UAAU,IAAI;IACjB,MAAM,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IAEnC,IAAI,OAAO,GAAuB,SAAS,CAAC;IAC5C,IAAI,QAAQ,GAAG,OAAO,CAAC,GAAG,CAAC,wBAAwB,CAAC;IACpD,IAAI,MAAM,GAAuB,SAAS,CAAC;IAC3C,IAAI,IAAI,GAAY,KAAK,CAAC;IAE1B,OAAO,CAAC,KAAK,CAAC,uDAAuD,CAAC,CAAC;IAEvE,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,KAAK,QAAQ,IAAI,GAAG,KAAK,IAAI,CAAC,EAAE,CAAC;QACzD,SAAS,EAAE,CAAC;QACZ,OAAO;IACT,CAAC;IAED,IAAI,GAAG,GAAG,CAAC,CAAC;IACZ,OAAO,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;QACzB,QAAQ,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;YAClB,KAAK,YAAY;gBACf,QAAQ,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;gBAC5B,MAAM;YACR,KAAK,IAAI,CAAC;YACV,KAAK,UAAU;gBACb,MAAM,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;gBAC1B,MAAM;YACR,KAAK,QAAQ;gBACX,IAAI,GAAG,IAAI,CAAC;gBACZ,MAAM;YACR;gBACE,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;gBACpB,MAAM;QACV,CAAC;QACD,GAAG,IAAI,CAAC,CAAC;IACX,CAAC;IAED,IAAI,GAAG,GAAG,CAAC,IAAI,IAAI,CAAC,MAAM,EAAE,CAAC;QAC3B,OAAO,CAAC,KAAK,CAAC,4BAA4B,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;IAC7E,CAAC;IAED,IAAI,CAAC,OAAO,EAAE,CAAC;QACb,MAAM,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC;IAC1C,CAAC;IAED,IAAI,CAAC,QAAQ,EAAE,CAAC;QACd,MAAM,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC;IAC1C,CAAC;IAED,MAAM,MAAM,GAAG,IAAI,wEAAiC,CAAC,QAAQ,EAAE,IAAI,iCAAsB,EAAE,CAAC,CAAC;IAE7F,MAAM,SAAS,GAAG,MAAM,MAAM,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;IAEzD,OAAO,CAAC,KAAK,CAAC,4BAA4B,EAAE,SAAS,CAAC,OAAO,CAAC,CAAC;IAE/D,MAAM,IAAI,GAAG,MAAM,IAAA,kCAAc,EAAC,SAAS,EAAE,IAAI,CAAC,CAAC;IAEnD,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,IAAA,iBAAM,EAAC,IAAI,EAAE,EAAE,MAAM,EAAE,YAAY,EAAE,CAAC,EAAE,OAAO,CAAC,CAAC;IAEhF,IAAI,MAAM,KAAK,SAAS,EAAE,CAAC;QACzB,mFAAmF;QACnF,MAAM,IAAI,GAAG,MAAM,CAAC;QAEpB,MAAM,IAAA,oBAAS,EAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IAC9B,CAAC;SAAM,CAAC;QACN,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;AACH,CAAC;AAED,IAAI,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE;IACjB,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IACjB,OAAO,CAAC,KAAK,CAAC,6CAA6C,CAAC,CAAC;IAC7D,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AAClB,CAAC,CAAC,CAAC","sourcesContent":["#!/bin/env node\n\n// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\n// This file is ignored by the linter because it is impossible to move the copyright header above the shebang line.\n\nimport { DefaultAzureCredential } from \"@azure/identity\";\nimport { writeFile } from \"node:fs/promises\";\nimport { DocumentModelAdministrationClient } from \"../documentModelAdministrationClient.js\";\nimport { writeModelCode } from \"./writeModelCode.js\";\nimport { format } from \"prettier\";\n\n/**\n * @internal\n * Prints a help message for the gen-model command.\n */\nfunction printHelp(): void {\n  console.error(`\nUsage:\n gen-model [options] <model-id>\n \nCreate a strongly-typed DocumentModel for the Azure Document Intelligence SDK for JavaScript.\n\nOptions:\n -h, --help  \\tshow this help message\n -o, --output\\tdetermines where to output the model\n\n --endpoint <endpoint>\\tthe Form Recognizer resource's endpoint\n\nDefault values:\n\nIf the \\`--endpoint\\` option is not provided, then the value\nof the \\`FORM_RECOGNIZER_ENDPOINT\\` environment\nvariable will be used as default.\n\nAuthentication:\n\nIf the \\`@azure/identity\\` package is installed, the \\`DefaultAzureCredential\\`\nfrom that package will be used.\n`);\n}\n\n/**\n * @internal\n * The main function of the gen-model command.\n */\nasync function main(): Promise<void> {\n  const args = process.argv.slice(2);\n\n  let modelId: string | undefined = undefined;\n  let endpoint = process.env.FORM_RECOGNIZER_ENDPOINT;\n  let output: string | undefined = undefined;\n  let test: boolean = false;\n\n  console.error(\"gen-model - create strong TypeScript types for models\");\n\n  if (args.some((arg) => arg === \"--help\" || arg === \"-h\")) {\n    printHelp();\n    return;\n  }\n\n  let idx = 0;\n  while (idx < args.length) {\n    switch (args[idx]) {\n      case \"--endpoint\":\n        endpoint = args[(idx += 1)];\n        break;\n      case \"-o\":\n      case \"--output\":\n        output = args[(idx += 1)];\n        break;\n      case \"--test\":\n        test = true;\n        break;\n      default:\n        modelId = args[idx];\n        break;\n    }\n    idx += 1;\n  }\n\n  if (idx + 1 <= args.length) {\n    console.error(\"warning: unused arguments:\", args.slice(idx + 1).join(\" \"));\n  }\n\n  if (!modelId) {\n    throw new Error(\"no model ID provided\");\n  }\n\n  if (!endpoint) {\n    throw new Error(\"no endpoint provided\");\n  }\n\n  const client = new DocumentModelAdministrationClient(endpoint, new DefaultAzureCredential());\n\n  const modelInfo = await client.getDocumentModel(modelId);\n\n  console.error(\"Generating model code for:\", modelInfo.modelId);\n\n  const file = await writeModelCode(modelInfo, test);\n\n  const data = Buffer.from(await format(file, { parser: \"typescript\" }), \"utf-8\");\n\n  if (output !== undefined) {\n    // output is only refined in this context, so assigning it to \"path\" preserves that\n    const path = output;\n\n    await writeFile(path, data);\n  } else {\n    process.stdout.write(data);\n  }\n}\n\nmain().catch((e) => {\n  console.error(e);\n  console.error(\"see `gen-model --help` for more information\");\n  process.exit(1);\n});\n"]}